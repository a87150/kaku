{% if request.user.is_authenticated %}
<div class="panel panel-default" style="width: 100px;">
    <div class="panel-heading">
        <h4 class="panel-title">
            <a data-toggle="collapse" data-parent="#accordion" 
               href="#collapseOne">
                添加标签
            </a>
        </h4>
    </div>
    <div id="collapseOne" class="panel-collapse collapse">
        <div class="input-group" id="addtag" style="width: 200px;">
            <input type="text" class="form-control" placeholder="tag" id="tag_input"/>
            <span class="input-group-btn">
                <button type="button" class="btn btn-default" id="tag_post">添加</button>
            </span>
        </div>
    </div>
</div>

<script>
$.ajaxSetup({
    data: {csrfmiddlewaretoken: '{{ csrf_token }}' },
});

$(document).ready(function(){
    $("#tag_post").click(function(){
        var tag = $("#tag_input").val();
        var id = $('.id').text();
        var type = $('.type').text();

        if (tag == '') {
            alert('不能为空');
        }
        else{
            $(this).attr("disabled","true");
            setTimeout("$('#tag_post').removeAttr('disabled')",3000);
            $.post("/tags/",{'tag':tag, 'id':id, 'type':type}, function(ret){
                $("#addtag").after("\<div class=\"alert alert-warning\"><a href=\"#\" class=\"close\" data-dismiss=\"alert\">&times;</a><strong>"+ret+"</strong></div>");
            });
        }
    });
});
</script>
{% else %}
    <div class="card card-block">
        需要登录才能添加
    </div>
{% endif %}